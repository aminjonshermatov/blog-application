(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{jkDv:function(t,e,n){"use strict";n.r(e),n.d(e,"AdminModule",function(){return Z});var i=n("ofXK"),r=n("tyNb"),s=n("3Pt+"),o=n("fXoL"),c=n("+zHE"),a=n("XNiG");let b=(()=>{class t{constructor(){this.alert$=new a.a}success(t){this.alert$.next({type:"success",text:t})}warning(t){this.alert$.next({type:"warning",text:t})}danger(t){this.alert$.next({type:"danger",text:t})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=o.Eb({token:t,factory:t.\u0275fac}),t})();const l=function(t,e,n){return{"alert-success":t,"alert-warning":e,"alert-danger":n}};function u(t,e){if(1&t&&(o.Lb(0,"div",1),o.Lb(1,"div",2),o.Lb(2,"p"),o.nc(3),o.Kb(),o.Kb(),o.Kb()),2&t){const t=o.Ub();o.yb(1),o.bc("ngClass",o.ec(2,l,"success"===t.type,"warning"===t.type,"danger"===t.type)),o.yb(2),o.oc(t.text)}}let d=(()=>{class t{constructor(t){this.alertService=t,this.delay=5e3,this.type="success"}ngOnInit(){this.aSub=this.alertService.alert$.subscribe(t=>{this.text=t.text,this.type=t.type;const e=setTimeout(()=>{this.text="",clearTimeout(e)},this.delay)})}ngOnDestroy(){this.aSub&&this.aSub.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(o.Ib(b))},t.\u0275cmp=o.Cb({type:t,selectors:[["app-alert"]],inputs:{delay:"delay"},decls:1,vars:1,consts:[["class","alert-wrap",4,"ngIf"],[1,"alert-wrap"],[1,"alert",3,"ngClass"]],template:function(t,e){1&t&&o.lc(0,u,4,6,"div",0),2&t&&o.bc("ngIf",e.text)},directives:[i.l,i.j],styles:[".alert-wrap[_ngcontent-%COMP%]{position:fixed;top:50px;right:40px;max-width:200px}"]}),t})();const f=function(){return["/admin","dashboard"]},m=function(){return["/admin","create"]};function h(t,e){if(1&t){const t=o.Mb();o.Lb(0,"ul"),o.Lb(1,"li",4),o.Lb(2,"a",5),o.nc(3,"Main"),o.Kb(),o.Kb(),o.Lb(4,"li",4),o.Lb(5,"a",5),o.nc(6,"Create"),o.Kb(),o.Kb(),o.Lb(7,"li"),o.Lb(8,"a",6),o.Sb("click",function(e){return o.hc(t),o.Ub().logout(e)}),o.nc(9,"Logout"),o.Kb(),o.Kb(),o.Kb()}2&t&&(o.yb(2),o.bc("routerLink",o.cc(2,f)),o.yb(3),o.bc("routerLink",o.cc(3,m)))}let g=(()=>{class t{constructor(t,e){this.router=t,this.auth=e}ngOnInit(){}logout(t){t.preventDefault(),this.auth.logout(),this.router.navigate(["/admin","login"])}}return t.\u0275fac=function(e){return new(e||t)(o.Ib(r.c),o.Ib(c.a))},t.\u0275cmp=o.Cb({type:t,selectors:[["app-admin-layout"]],decls:8,vars:1,consts:[[1,"navbar","bg-primary"],["routerLink","/"],[4,"ngIf"],[1,"container"],["routerLinkActive","active"],[3,"routerLink"],["href","#",3,"click"]],template:function(t,e){1&t&&(o.Jb(0,"app-alert"),o.Lb(1,"nav",0),o.Lb(2,"h1"),o.Lb(3,"a",1),o.nc(4,"Angular Admin"),o.Kb(),o.Kb(),o.lc(5,h,10,4,"ul",2),o.Kb(),o.Lb(6,"div",3),o.Jb(7,"router-outlet"),o.Kb()),2&t&&(o.yb(5),o.bc("ngIf",e.auth.isAuthenticated()))},directives:[d,r.f,i.l,r.h,r.e],encapsulation:2}),t})();function p(t,e){if(1&t&&(o.Lb(0,"div",10),o.nc(1),o.Kb()),2&t){const t=e.ngIf;o.yb(1),o.oc(t)}}function v(t,e){if(1&t&&(o.Lb(0,"div",11),o.nc(1),o.Kb()),2&t){const t=o.Ub();o.yb(1),o.oc(t.message)}}function y(t,e){1&t&&(o.Lb(0,"small"),o.nc(1,"Email is required"),o.Kb())}function L(t,e){1&t&&(o.Lb(0,"small"),o.nc(1,"Email is not valid"),o.Kb())}function K(t,e){if(1&t&&(o.Lb(0,"div",12),o.lc(1,y,2,0,"small",13),o.lc(2,L,2,0,"small",13),o.Kb()),2&t){const t=o.Ub();o.yb(1),o.bc("ngIf",t.form.get("email").errors.required),o.yb(1),o.bc("ngIf",t.form.get("email").errors.email)}}function w(t,e){1&t&&(o.Lb(0,"small"),o.nc(1,"Password is required"),o.Kb())}function I(t,e){if(1&t&&(o.Lb(0,"small"),o.nc(1),o.Kb()),2&t){const t=o.Ub(2);o.yb(1),o.pc(" Password must be more than ",t.form.get("password").errors.minlength.requiredLength," symbols. Now ",t.form.get("password").errors.minlength.actualLength,". ")}}function S(t,e){if(1&t&&(o.Lb(0,"div",12),o.lc(1,w,2,0,"small",13),o.lc(2,I,2,2,"small",13),o.Kb()),2&t){const t=o.Ub();o.yb(1),o.bc("ngIf",t.form.get("password").errors.required),o.yb(1),o.bc("ngIf",t.form.get("password").errors.minlength)}}const x=function(t){return{invalid:t}};let C=(()=>{class t{constructor(t,e,n){this.auth=t,this.router=e,this.route=n,this.submitted=!1}ngOnInit(){this.route.queryParams.subscribe(t=>{t.loginAgain?this.message="Please login":t.authFailed&&(this.message="Session is expires, please login again")}),this.form=new s.d({email:new s.b(null,[s.m.required,s.m.email]),password:new s.b(null,[s.m.required,s.m.minLength(6)])})}submit(){this.form.invalid||(this.submitted=!0,this.auth.login({email:this.form.value.email,password:this.form.value.password}).subscribe(()=>{this.form.reset(),this.router.navigate(["/admin","dashboard"]),this.submitted=!1},()=>{this.submitted=!1}))}}return t.\u0275fac=function(e){return new(e||t)(o.Ib(c.a),o.Ib(r.c),o.Ib(r.a))},t.\u0275cmp=o.Cb({type:t,selectors:[["app-login-page"]],decls:18,vars:14,consts:[[1,"card",3,"formGroup","ngSubmit"],["class","alert alert-danger",4,"ngIf"],["class","alert alert-info",4,"ngIf"],[1,"form-control",3,"ngClass"],["for","email"],["id","email","type","email","formControlName","email"],["class","validation",4,"ngIf"],["for","password"],["id","password","type","password","formControlName","password"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"alert","alert-danger"],[1,"alert","alert-info"],[1,"validation"],[4,"ngIf"]],template:function(t,e){1&t&&(o.Lb(0,"form",0),o.Sb("ngSubmit",function(){return e.submit()}),o.Lb(1,"h2"),o.nc(2,"Login to Admin page"),o.Kb(),o.lc(3,p,2,1,"div",1),o.Vb(4,"async"),o.lc(5,v,2,1,"div",2),o.Lb(6,"div",3),o.Lb(7,"label",4),o.nc(8,"Email:"),o.Kb(),o.Jb(9,"input",5),o.lc(10,K,3,2,"div",6),o.Kb(),o.Lb(11,"div",3),o.Lb(12,"label",7),o.nc(13,"Password:"),o.Kb(),o.Jb(14,"input",8),o.lc(15,S,3,2,"div",6),o.Kb(),o.Lb(16,"button",9),o.nc(17,"Login"),o.Kb(),o.Kb()),2&t&&(o.bc("formGroup",e.form),o.yb(3),o.bc("ngIf",o.Wb(4,8,e.auth.error$)),o.yb(2),o.bc("ngIf",e.message),o.yb(1),o.bc("ngClass",o.dc(10,x,e.form.get("email").touched&&e.form.get("email").invalid)),o.yb(4),o.bc("ngIf",e.form.get("email").touched&&e.form.get("email").invalid),o.yb(1),o.bc("ngClass",o.dc(12,x,e.form.get("password").touched&&e.form.get("password").invalid)),o.yb(4),o.bc("ngIf",e.form.get("password").touched&&e.form.get("password").invalid),o.yb(1),o.bc("disabled",e.form.invalid||e.submitted))},directives:[s.n,s.j,s.e,i.l,i.j,s.a,s.i,s.c],pipes:[i.b],styles:["form[_ngcontent-%COMP%]{max-width:600px;margin:0 auto}"]}),t})();var q=n("ZBX8");let k=(()=>{class t{transform(t,e=""){if(!e.trim())return t;t.filter(t=>t.title.toLowerCase().includes(e.toLowerCase()))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=o.Hb({name:"searchPosts",type:t,pure:!0}),t})();function P(t,e){if(1&t){const t=o.Mb();o.Lb(0,"div",4),o.Lb(1,"input",5),o.Sb("ngModelChange",function(e){return o.hc(t),o.Ub(2).searchStr=e}),o.Kb(),o.Kb()}if(2&t){const t=o.Ub(2);o.yb(1),o.bc("ngModel",t.searchStr)}}const O=function(t){return["/admin","post",t,"edit"]};function A(t,e){if(1&t){const t=o.Mb();o.Lb(0,"tr"),o.Lb(1,"td"),o.nc(2),o.Kb(),o.Lb(3,"td"),o.nc(4),o.Kb(),o.Lb(5,"td"),o.nc(6),o.Kb(),o.Lb(7,"td"),o.nc(8),o.Vb(9,"date"),o.Kb(),o.Lb(10,"td"),o.Lb(11,"button",6),o.nc(12," Edit "),o.Kb(),o.Lb(13,"a",7),o.Sb("click",function(){o.hc(t);const n=e.$implicit;return o.Ub(2).remove(n.id)}),o.nc(14,"Delete"),o.Kb(),o.Kb(),o.Kb()}if(2&t){const t=e.$implicit,n=e.index;o.yb(2),o.oc(n+1),o.yb(2),o.oc(t.author),o.yb(2),o.oc(t.title),o.yb(2),o.oc(o.Yb(9,5,t.date,"medium",null,"ru")),o.yb(3),o.bc("routerLink",o.dc(10,O,t.id))}}function U(t,e){if(1&t&&(o.Lb(0,"div"),o.lc(1,P,2,1,"div",2),o.Lb(2,"table"),o.Lb(3,"thead"),o.Lb(4,"tr"),o.Lb(5,"th"),o.nc(6,"#"),o.Kb(),o.Lb(7,"th"),o.nc(8,"Author"),o.Kb(),o.Lb(9,"th"),o.nc(10,"Title"),o.Kb(),o.Lb(11,"th"),o.nc(12,"Date"),o.Kb(),o.Lb(13,"th"),o.nc(14,"Action"),o.Kb(),o.Kb(),o.Kb(),o.Lb(15,"tbody"),o.lc(16,A,15,12,"tr",3),o.Vb(17,"searchPosts"),o.Kb(),o.Kb(),o.Kb()),2&t){const t=o.Ub();o.yb(1),o.bc("ngIf",t.posts.length>1),o.yb(15),o.bc("ngForOf",o.Xb(17,2,t.posts,t.searchStr))}}function M(t,e){1&t&&(o.Lb(0,"p",8),o.nc(1," Loading... "),o.Kb())}let j=(()=>{class t{constructor(t,e){this.postsService=t,this.alertService=e,this.posts=[],this.searchStr=""}ngOnInit(){this.pSub=this.postsService.getAll().subscribe(t=>{this.posts=t})}ngOnDestroy(){this.pSub&&this.pSub.unsubscribe(),this.dSub&&this.dSub.unsubscribe()}remove(t){this.dSub=this.postsService.remove(t).subscribe(()=>{this.posts=this.posts.filter(e=>e.id!==t),this.alertService.danger("Post was deleted")})}}return t.\u0275fac=function(e){return new(e||t)(o.Ib(q.a),o.Ib(b))},t.\u0275cmp=o.Cb({type:t,selectors:[["app-dashboard-page"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["loading",""],["class","form-control",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"form-control"],["type","text","placeholder","Find post...",3,"ngModel","ngModelChange"],[1,"btn","btn-link","open",3,"routerLink"],[3,"click"],[1,"text-center"]],template:function(t,e){if(1&t&&(o.lc(0,U,18,5,"div",0),o.lc(1,M,2,0,"ng-template",null,1,o.mc)),2&t){const t=o.gc(2);o.bc("ngIf",e.posts.length)("ngIfElse",t)}},directives:[i.l,i.k,s.a,s.i,s.k,r.d],pipes:[k,i.e],styles:[".open[_ngcontent-%COMP%]{margin-right:10px}"]}),t})();var E=n("CzEO");function J(t,e){1&t&&(o.Lb(0,"small"),o.nc(1,"Title is required"),o.Kb())}function N(t,e){if(1&t&&(o.Lb(0,"div",10),o.lc(1,J,2,0,"small",11),o.Kb()),2&t){const t=o.Ub();o.yb(1),o.bc("ngIf",t.form.get("title").errors.required)}}function D(t,e){1&t&&(o.Lb(0,"small"),o.nc(1,"Author is required"),o.Kb())}function G(t,e){if(1&t&&(o.Lb(0,"div",10),o.lc(1,D,2,0,"small",11),o.Kb()),2&t){const t=o.Ub();o.yb(1),o.bc("ngIf",t.form.get("author").errors.required)}}const T=function(t){return{invalid:t}};let $=(()=>{class t{constructor(t,e){this.postsService=t,this.alertService=e}ngOnInit(){this.form=new s.d({title:new s.b(null,[s.m.required]),text:new s.b(null,[s.m.required]),author:new s.b(null,[s.m.required])})}submit(){if(this.form.invalid)return;const t={title:this.form.value.title,text:this.form.value.text,author:this.form.value.author,date:new Date};this.postsService.create(t).subscribe(()=>{this.form.reset(),this.alertService.success("Post was created")})}}return t.\u0275fac=function(e){return new(e||t)(o.Ib(q.a),o.Ib(b))},t.\u0275cmp=o.Cb({type:t,selectors:[["app-create-page"]],decls:19,vars:10,consts:[[3,"formGroup","ngSubmit"],[1,"form-control",3,"ngClass"],["for","title"],["type","text","id","title","formControlName","title"],["class","validation",4,"ngIf"],[1,"form-control"],["formControlName","text"],["for","author"],["type","text","id","author","formControlName","author"],["type","submit",1,"btn","btn-block","btn-dark",3,"disabled"],[1,"validation"],[4,"ngIf"]],template:function(t,e){1&t&&(o.Lb(0,"form",0),o.Sb("ngSubmit",function(){return e.submit()}),o.Lb(1,"h1"),o.nc(2,"Create new post"),o.Kb(),o.Lb(3,"div",1),o.Lb(4,"label",2),o.nc(5,"Title:"),o.Kb(),o.Jb(6,"input",3),o.lc(7,N,2,1,"div",4),o.Kb(),o.Lb(8,"div",5),o.Lb(9,"label"),o.nc(10,"Post content:"),o.Kb(),o.Jb(11,"quill-editor",6),o.Kb(),o.Lb(12,"div",1),o.Lb(13,"label",7),o.nc(14,"Author:"),o.Kb(),o.Jb(15,"input",8),o.lc(16,G,2,1,"div",4),o.Kb(),o.Lb(17,"button",9),o.nc(18,"Create post"),o.Kb(),o.Kb()),2&t&&(o.bc("formGroup",e.form),o.yb(3),o.bc("ngClass",o.dc(6,T,e.form.get("title").touched&&e.form.get("title").errors)),o.yb(4),o.bc("ngIf",e.form.get("title").touched&&e.form.get("title").errors),o.yb(5),o.bc("ngClass",o.dc(8,T,e.form.get("author").touched&&e.form.get("author").errors)),o.yb(4),o.bc("ngIf",e.form.get("author").touched&&e.form.get("author").errors),o.yb(1),o.bc("disabled",e.form.invalid))},directives:[s.n,s.j,s.e,i.j,s.a,s.i,s.c,i.l,E.a],styles:["form[_ngcontent-%COMP%]{max-width:600px;margin:0 auto}"]}),t})();var F=n("eIep");function X(t,e){1&t&&(o.Lb(0,"small"),o.nc(1,"Title is required"),o.Kb())}function _(t,e){if(1&t&&(o.Lb(0,"div",10),o.lc(1,X,2,0,"small",11),o.Kb()),2&t){const t=o.Ub(2);o.yb(1),o.bc("ngIf",t.form.get("title").errors.required)}}const V=function(t){return{invalid:t}};function z(t,e){if(1&t){const t=o.Mb();o.Lb(0,"div"),o.Lb(1,"form",2),o.Sb("ngSubmit",function(){return o.hc(t),o.Ub().submit()}),o.Lb(2,"div",3),o.Lb(3,"label",4),o.nc(4,"Title:"),o.Kb(),o.Jb(5,"input",5),o.lc(6,_,2,1,"div",6),o.Kb(),o.Lb(7,"div",7),o.Jb(8,"quill-editor",8),o.Kb(),o.Lb(9,"button",9),o.nc(10,"Update"),o.Kb(),o.Kb(),o.Kb()}if(2&t){const t=o.Ub();o.yb(1),o.bc("formGroup",t.form),o.yb(1),o.bc("ngClass",o.dc(4,V,t.form.get("title").touched&&t.form.get("title").errors)),o.yb(4),o.bc("ngIf",t.form.get("title").touched&&t.form.get("title").errors),o.yb(3),o.bc("disabled",t.form.invalid||t.submitted)}}function B(t,e){1&t&&(o.Lb(0,"p",12),o.nc(1," Loading... "),o.Kb())}let H=(()=>{class t{constructor(t,e,n,i){this.route=t,this.postsService=e,this.router=n,this.alertService=i,this.submitted=!1}ngOnInit(){this.route.params.pipe(Object(F.a)(t=>this.postsService.getById(t.id))).subscribe(t=>{this.post=t,this.form=new s.d({title:new s.b(t.title,[s.m.required]),text:new s.b(t.text,[s.m.required])})})}submit(){this.form.invalid||(this.submitted=!0,this.uSub=this.postsService.update(Object.assign(Object.assign({},this.post),{text:this.form.value.text,title:this.form.value.title})).subscribe(()=>{this.submitted=!1,this.alertService.success("Post was updated"),this.router.navigate(["/admin","dashboard"])}))}ngOnDestroy(){this.uSub&&this.uSub.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(o.Ib(r.a),o.Ib(q.a),o.Ib(r.c),o.Ib(b))},t.\u0275cmp=o.Cb({type:t,selectors:[["app-edit-page"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["loading",""],[3,"formGroup","ngSubmit"],[1,"form-control",3,"ngClass"],["for","title"],["type","text","id","title","formControlName","title"],["class","validation",4,"ngIf"],[1,"form-control"],["formControlName","text"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"validation"],[4,"ngIf"],[1,"text-center"]],template:function(t,e){if(1&t&&(o.lc(0,z,11,6,"div",0),o.lc(1,B,2,0,"ng-template",null,1,o.mc)),2&t){const t=o.gc(2);o.bc("ngIf",e.form)("ngIfElse",t)}},directives:[i.l,s.n,s.j,s.e,i.j,s.a,s.i,s.c,E.a],styles:[""]}),t})();var W=n("PCNd");let Y=(()=>{class t{constructor(t,e){this.auth=t,this.router=e}canActivate(t,e){return!!this.auth.isAuthenticated()||(this.auth.logout(),this.router.navigate(["/admin","login"],{queryParams:{loginAgain:!0}}),!1)}}return t.\u0275fac=function(e){return new(e||t)(o.Pb(c.a),o.Pb(r.c))},t.\u0275prov=o.Eb({token:t,factory:t.\u0275fac}),t})(),Z=(()=>{class t{}return t.\u0275mod=o.Gb({type:t}),t.\u0275inj=o.Fb({factory:function(e){return new(e||t)},providers:[Y,b],imports:[[i.c,s.f,s.l,W.a,r.g.forChild([{path:"",component:g,children:[{path:"",redirectTo:"/admin/login",pathMatch:"full"},{path:"login",component:C},{path:"dashboard",component:j,canActivate:[Y]},{path:"create",component:$,canActivate:[Y]},{path:"post/:id/edit",component:H,canActivate:[Y]}]}])],r.g]}),t})()}}]);